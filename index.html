<!DOCTYPE html>
<html>
    <head>
        <title>Web3 Testbed</title>
    </head>
    <body>
        
        <div id="reports">
            <ol>
                <li v-for="report in ethReports">
                    {{ report.longitude }} | {{ report.latitude }}
                </li>
            </ol>
        </div>
            
            <div id="app">

              <p>
                <label for="name">Longitude: <label>
                <input type="text" name="longitude" id="longitude" v-model="this.alongitude">
              </p>

              <p>
                <label for="name">Latitude: <label>
                <input type="text" name="latitude" id="latitude" v-model="this.alatitude">
              </p>

              <p>
                  <button v-on:click="app.manual">Manual Entry</button>
                  <button v-on:click="app.GPS">GPS Entry</button>
              </p>

            </div>
        
        
        
        
        <!-- Le Javascript -->
        
        <script src="https://cdn.jsdelivr.net/npm/web3@0.19.0/dist/web3.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/vue"></script>
        
        <script>
            
                    if ("geolocation" in navigator) {
                      /* geolocation is available */
                        navigator.geolocation.getCurrentPosition(function(position) {
                            addReports.x = position.coords.latitude
                            addReports.y = position.coords.longitude
                        });
                    }
            
            

            
            // WEB3 INITIALIZATION
        
          window.addEventListener("load", function() {
            // Checking if Web3 has been injected by the browser (Mist/MetaMask)
            if (typeof web3 !== "undefined") {
              // Use Mist/MetaMask's provider
              window.web3 = new Web3(web3.currentProvider);
            } else {
              console.log("No web3? You should consider trying MetaMask!");
              // fallback - use your fallback strategy (local node / hosted node + in-dapp id mgmt / fail)
              window.web3 = new Web3(
                new Web3.providers.HttpProvider("https://localhost:8545")
              );
            }
          })
            
                    
      
            // VUE + WEB3 APPLICATION
            
      
            var reports = new Vue({
                el: '#reports',
                data: {
                    ethReports: [
                        {longitude: '100', latitude: '200'}
                    ]   
                }
            })
            
            var addReports = new Vue({
                el: '#app',
                data: {
                    alongitude:null,
                    alatitude:null,
                    x: 0,
                    y: 0
                },
                methods: {
                 GPS: function(){
                     reports.ethReports.push({longitude: addReports.x, latitude: addReports.y})
                 },
                 manual: function(){
                     reports.ethReports.push({longitude: app.alongitude, latitude: app.alatitude})
                 }
                }
            })
              
        </script>
    </body>
</html>
